PS: the code here doesn't contain the events codes.

!function(a){"use strict";function r(a,b,c){if(c[0]&&"object"!=typeof c[0]){if(b[c[0]])return b[c[0]].apply(a,Array.prototype.slice.call(c,1));throw F(c[0]+" is not a method or property")}return b.init.apply(a,c)}function s(a,b,c,d){return{css:{position:"absolute",top:a,left:b,overflow:d||"hidden",zIndex:c||"auto"}}}function t(a,b,c,d,e){var f=1-e,g=f*f*f,h=e*e*e;return w(Math.round(g*a.x+3*e*f*f*b.x+3*e*e*f*c.x+h*d.x),Math.round(g*a.y+3*e*f*f*b.y+3*e*e*f*c.y+h*d.y))}function v(a){return a/f*180}function w(a,b){return{x:a,y:b}}function x(){var a;if(a=/AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent)){return parseFloat(a[1])>534.3}return!0}function y(a,c,d){return b&&d?" translate3d("+a+"px,"+c+"px, 0px) ":" translate("+a+"px, "+c+"px) "}function z(a){return" rotate("+a+"deg) "}function A(a,b){return Object.prototype.hasOwnProperty.call(b,a)}function B(){for(var a=["Moz","Webkit","Khtml","O","ms"],b=a.length,c="";b--;)a[b]+"Transform"in document.body.style&&(c="-"+a[b].toLowerCase()+"-");return c}function C(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a]}function D(a,b,c,e,f){var g,h=[];if("-webkit-"==d){for(g=0;g<f;g++)h.push("color-stop("+e[g][0]+", "+e[g][1]+")");a.css({"background-image":"-webkit-gradient(linear, "+b.x+"% "+b.y+"%,"+c.x+"% "+c.y+"%, "+h.join(",")+" )"})}else{b={x:b.x/100*a.width(),y:b.y/100*a.height()},c={x:c.x/100*a.width(),y:c.y/100*a.height()};var i=c.x-b.x,j=c.y-b.y,k=Math.atan2(j,i),l=k-Math.PI/2,m=Math.abs(a.width()*Math.sin(l))+Math.abs(a.height()*Math.cos(l)),n=Math.sqrt(j*j+i*i),o=w(c.x<b.x?a.width():0,c.y<b.y?a.height():0),p=Math.tan(k),q=-1/p,r=(q*o.x-o.y-p*b.x+b.y)/(q-p),s={x:r,y:q*r-q*o.x+o.y},t=Math.sqrt(Math.pow(s.x-b.x,2)+Math.pow(s.y-b.y,2));for(g=0;g<f;g++)h.push(" "+e[g][1]+" "+100*(t+n*e[g][0])/m+"%");a.css({"background-image":d+"linear-gradient("+-k+"rad,"+h.join(",")+")"})}}function E(b,c,d){var e=a.Event(b);return c.trigger(e,d),e.isDefaultPrevented()?"prevented":e.isPropagationStopped()?"stopped":""}function F(a){function b(a){this.name="TurnJsError",this.message=a}return b.prototype=new Error,b.prototype.constructor=b,new b(a)}function G(a){var b={top:0,left:0};do{b.left+=a.offsetLeft,b.top+=a.offsetTop}while(a=a.offsetParent);return b}function H(){return-1==navigator.userAgent.indexOf("MSIE 9.0")}var b,c,d="",e="4.1.0",f=Math.PI,g=f/2,h="ontouchstart"in window,i=h?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},j={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br","l","r"]},k=["single","double"],l=["ltr","rtl"],m={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",when:null},n={cornerSize:100},o=6,p={init:function(e){b="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style,c=x(),d=B();var f,j=0,k=this.data(),l=this.children();if(e=a.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},m,e),k.opts=e,k.pageObjs={},k.pages={},k.pageWrap={},k.pageZoom={},k.pagePlace={},k.pageMv=[],k.zoom=1,k.totalPages=e.pages||0,k.eventHandlers={touchStart:a.proxy(p._touchStart,this),touchMove:a.proxy(p._touchMove,this),touchEnd:a.proxy(p._touchEnd,this),start:a.proxy(p._eventStart,this)},e.when)for(f in e.when)A(f,e.when)&&this.bind(f,e.when[f]);for(this.css({position:"relative",width:e.width,height:e.height}),this.turn("display",e.display),""!==e.direction&&this.turn("direction",e.direction),b&&!h&&e.acceleration&&this.transform(y(0,0,!0)),f=0;f<l.length;f++)"1"!=a(l[f]).attr("ignore")&&this.turn("addPage",l[f],++j);return a(this).bind(i.down,k.eventHandlers.touchStart).bind("end",p._eventEnd).bind("pressed",p._eventPressed).bind("released",p._eventReleased).bind("flip",p._flip),a(this).parent().bind("start",k.eventHandlers.start),a(document).bind(i.move,k.eventHandlers.touchMove).bind(i.up,k.eventHandlers.touchEnd),this.turn("page",e.page),k.done=!0,this},addPage:function(b,c){var d,e,f=!1,g=this.data(),h=g.totalPages+1;if(g.destroying)return!1;if((d=/\bp([0-9]+)\b/.exec(a(b).attr("class")))&&(c=parseInt(d[1],10)),c){if(c==h)f=!0;else if(c>h)throw F('Page "'+c+'" cannot be inserted')}else c=h,f=!0;return c>=1&&c<=h&&(e="double"==g.display?c%2?" odd":" even":"",g.done&&this.turn("stop"),c in g.pageObjs&&p._movePages.call(this,c,1),f&&(g.totalPages=h),g.pageObjs[c]=a(b).css({float:"left"}).addClass("page p"+c+e),!H()&&g.pageObjs[c].hasClass("hard")&&g.pageObjs[c].removeClass("hard"),p._addPage.call(this,c),p._removeFromDOM.call(this)),this},_addPage:function(b){var c=this.data(),d=c.pageObjs[b];if(d)if(p._necessPage.call(this,b)){if(!c.pageWrap[b]){c.pageWrap[b]=a("<div/>",{class:"page-wrapper",page:b,css:{position:"absolute",overflow:"hidden"}}),this.append(c.pageWrap[b]),c.pagePlace[b]||(c.pagePlace[b]=b,c.pageObjs[b].appendTo(c.pageWrap[b]));var e=p._pageSize.call(this,b,!0);d.css({width:e.width,height:e.height}),c.pageWrap[b].css(e)}c.pagePlace[b]==b&&p._makeFlip.call(this,b)}else c.pagePlace[b]=0,c.pageObjs[b]&&c.pageObjs[b].remove()},hasPage:function(a){return A(a,this.data().pageObjs)},center:function(b){var c=this.data(),d=a(this).turn("size"),e=0;if(!c.noCenter){if("double"==c.display){var f=this.turn("view",b||c.tpage||c.page);"ltr"==c.direction?f[0]?f[1]||(e+=d.width/4):e-=d.width/4:f[0]?f[1]||(e-=d.width/4):e+=d.width/4}a(this).css({marginLeft:e})}return this},destroy:function(){var c=this,d=this.data(),e=["end","first","flip","last","pressed","released","start","turning","turned","zooming","missing"];if("prevented"!=E("destroying",this)){for(d.destroying=!0,a.each(e,function(a,b){c.unbind(b)}),this.parent().unbind("start",d.eventHandlers.start),a(document).unbind(i.move,d.eventHandlers.touchMove).unbind(i.up,d.eventHandlers.touchEnd);0!==d.totalPages;)this.turn("removePage",d.totalPages);return d.fparent&&d.fparent.remove(),d.shadow&&d.shadow.remove(),this.removeData(),d=null,this}},is:function(){return"object"==typeof this.data().pages},zoom:function(b){var c=this.data();if("number"==typeof b){if(b<.001||b>100)throw F(b+" is not a value for zoom");if("prevented"==E("zooming",this,[b,c.zoom]))return this;var d=this.turn("size"),e=this.turn("view"),f=1/c.zoom,g=Math.round(d.width*f*b),h=Math.round(d.height*f*b);c.zoom=b,a(this).turn("stop").turn("size",g,h),c.opts.autoCenter&&this.turn("center"),p._updateShadow.call(this);for(var i=0;i<e.length;i++)e[i]&&c.pageZoom[e[i]]!=c.zoom&&(this.trigger("zoomed",[e[i],e,c.pageZoom[e[i]],c.zoom]),c.pageZoom[e[i]]=c.zoom);return this}return c.zoom},_pageSize:function(a,b){var c=this.data(),d={};if("single"==c.display)d.width=this.width(),d.height=this.height(),b&&(d.top=0,d.left=0,d.right="auto");else{var e=this.width()/2,f=this.height();if(c.pageObjs[a].hasClass("own-size")?(d.width=c.pageObjs[a].width(),d.height=c.pageObjs[a].height()):(d.width=e,d.height=f),b){var g=a%2;d.top=(f-d.height)/2,"ltr"==c.direction?(d[g?"right":"left"]=e-d.width,d[g?"left":"right"]="auto"):(d[g?"left":"right"]=e-d.width,d[g?"right":"left"]="auto")}}return d},_makeFlip:function(a){var b=this.data();if(!b.pages[a]&&b.pagePlace[a]==a){var c="single"==b.display,d=a%2;b.pages[a]=b.pageObjs[a].css(p._pageSize.call(this,a)).flip({page:a,next:d||c?a+1:a-1,turn:this}).flip("disable",b.disabled),p._setPageLoc.call(this,a),b.pageZoom[a]=b.zoom}return b.pages[a]},_makeRange:function(){var a,b;if(!(this.data().totalPages<1))for(b=this.turn("range"),a=b[0];a<=b[1];a++)p._addPage.call(this,a)},range:function(a){var b,c,d,e,f=this.data();if(a=a||f.tpage||f.page||1,e=p._view.call(this,a),a<1||a>f.totalPages)throw F('"'+a+'" is not a valid page');return e[1]=e[1]||e[0],e[0]>=1&&e[1]<=f.totalPages?(b=Math.floor((o-2)/2),f.totalPages-e[1]>e[0]?(c=Math.min(e[0]-1,b),d=2*b-c):(d=Math.min(f.totalPages-e[1],b),c=2*b-d)):(c=o-1,d=o-1),[Math.max(1,e[0]-c),Math.min(f.totalPages,e[1]+d)]},_necessPage:function(a){if(0===a)return!0;var b=this.turn("range");return this.data().pageObjs[a].hasClass("fixed")||a>=b[0]&&a<=b[1]},_removeFromDOM:function(){var a,b=this.data();for(a in b.pageWrap)A(a,b.pageWrap)&&!p._necessPage.call(this,a)&&p._removePageFromDOM.call(this,a)},_removePageFromDOM:function(a){var b=this.data();if(b.pages[a]){var c=b.pages[a].data();q._moveFoldingPage.call(b.pages[a],!1),c.f&&c.f.fwrapper&&c.f.fwrapper.remove(),b.pages[a].removeData(),b.pages[a].remove(),delete b.pages[a]}b.pageObjs[a]&&b.pageObjs[a].remove(),b.pageWrap[a]&&(b.pageWrap[a].remove(),delete b.pageWrap[a]),p._removeMv.call(this,a),delete b.pagePlace[a],delete b.pageZoom[a]},removePage:function(a){var b=this.data();if("*"==a)for(;0!==b.totalPages;)this.turn("removePage",b.totalPages);else{if(a<1||a>b.totalPages)throw F("The page "+a+" doesn't exist");b.pageObjs[a]&&(this.turn("stop"),p._removePageFromDOM.call(this,a),delete b.pageObjs[a]),p._movePages.call(this,a,-1),b.totalPages=b.totalPages-1,b.page>b.totalPages?(b.page=null,p._fitPage.call(this,b.totalPages)):(p._makeRange.call(this),this.turn("update"))}return this},_movePages:function(a,b){var c,d=this,e=this.data(),f="single"==e.display,g=function(a){var c=a+b,g=c%2,h=g?" odd ":" even ";e.pageObjs[a]&&(e.pageObjs[c]=e.pageObjs[a].removeClass("p"+a+" odd even").addClass("p"+c+h)),e.pagePlace[a]&&e.pageWrap[a]&&(e.pagePlace[c]=c,e.pageObjs[c].hasClass("fixed")?e.pageWrap[c]=e.pageWrap[a].attr("page",c):e.pageWrap[c]=e.pageWrap[a].css(p._pageSize.call(d,c,!0)).attr("page",c),e.pages[a]&&(e.pages[c]=e.pages[a].flip("options",{page:c,next:f||g?c+1:c-1})),b&&(delete e.pages[a],delete e.pagePlace[a],delete e.pageZoom[a],delete e.pageObjs[a],delete e.pageWrap[a]))};if(b>0)for(c=e.totalPages;c>=a;c--)g(c);else for(c=a;c<=e.totalPages;c++)g(c)},display:function(b){var c=this.data(),d=c.display;if(void 0===b)return d;if(-1==a.inArray(b,k))throw F('"'+b+'" is not a value for display');switch(b){case"single":c.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),c.pageObjs[0]=a("<div />",{class:"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)),this.addClass("shadow");break;case"double":c.pageObjs[0]&&(this.turn("stop").css({overflow:""}),c.pageObjs[0].remove(),delete c.pageObjs[0]),this.removeClass("shadow")}if(c.display=b,d){var e=this.turn("size");p._movePages.call(this,1,0),this.turn("size",e.width,e.height).turn("update")}return this},direction:function(b){var c=this.data();if(void 0===b)return c.direction;if(b=b.toLowerCase(),-1==a.inArray(b,l))throw F('"'+b+'" is not a value for direction');return"rtl"==b&&a(this).attr("dir","ltr").css({direction:"ltr"}),c.direction=b,c.done&&this.turn("size",a(this).width(),a(this).height()),this},animating:function(){return this.data().pageMv.length>0},corner:function(){var a,b,c=this.data();for(b in c.pages)if(A(b,c.pages)&&(a=c.pages[b].flip("corner")))return a;return!1},data:function(){return this.data()},disable:function(b){var c,d=this.data(),e=this.turn("view");d.disabled=void 0===b||!0===b;for(c in d.pages)A(c,d.pages)&&d.pages[c].flip("disable",!!d.disabled||-1==a.inArray(parseInt(c,10),e));return this},disabled:function(a){return void 0===a?!0===this.data().disabled:this.turn("disable",a)},size:function(a,b){if(void 0===a||void 0===b)return{width:this.width(),height:this.height()};this.turn("stop");var c,d,e=this.data(),f="double"==e.display?a/2:a;this.css({width:a,height:b}),e.pageObjs[0]&&e.pageObjs[0].css({width:f,height:b});for(c in e.pageWrap)A(c,e.pageWrap)&&(d=p._pageSize.call(this,c,!0),e.pageObjs[c].css({width:d.width,height:d.height}),e.pageWrap[c].css(d),e.pages[c]&&e.pages[c].css({width:d.width,height:d.height}));return this.turn("resize"),this},resize:function(){var a,b=this.data();for(b.pages[0]&&(b.pageWrap[0].css({left:-this.width()}),b.pages[0].flip("resize",!0)),a=1;a<=b.totalPages;a++)b.pages[a]&&b.pages[a].flip("resize",!0);p._updateShadow.call(this),b.opts.autoCenter&&this.turn("center")},_removeMv:function(a){var b,c=this.data();for(b=0;b<c.pageMv.length;b++)if(c.pageMv[b]==a)return c.pageMv.splice(b,1),!0;return!1},_addMv:function(a){var b=this.data();p._removeMv.call(this,a),b.pageMv.push(a)},_view:function(a){var b=this.data();return a=a||b.page,"double"==b.display?a%2?[a-1,a]:[a,a+1]:[a]},view:function(a){var b=this.data(),c=p._view.call(this,a);return"double"==b.display?[c[0]>0?c[0]:0,c[1]<=b.totalPages?c[1]:0]:[c[0]>0&&c[0]<=b.totalPages?c[0]:0]},stop:function(a,b){if(this.turn("animating")){var c,d,e,f=this.data();for(f.tpage&&(f.page=f.tpage,delete f.tpage),c=0;c<f.pageMv.length;c++)f.pageMv[c]&&f.pageMv[c]!==a&&(e=f.pages[f.pageMv[c]],d=e.data().f.opts,e.flip("hideFoldedPage",b),b||q._moveFoldingPage.call(e,!1),d.force&&(d.next=d.page%2==0?d.page-1:d.page+1,delete d.force))}return this.turn("update"),this},pages:function(a){var b=this.data();if(a){if(a<b.totalPages)for(var c=b.totalPages;c>a;c--)this.turn("removePage",c);return b.totalPages=a,p._fitPage.call(this,b.page),this}return b.totalPages},_missing:function(a){var b=this.data();if(!(b.totalPages<1)){var c,d=this.turn("range",a),e=[];for(c=d[0];c<=d[1];c++)b.pageObjs[c]||e.push(c);e.length>0&&this.trigger("missing",[e])}},_fitPage:function(a){var b=this.data(),c=this.turn("view",a);if(p._missing.call(this,a),b.pageObjs[a]){b.page=a,this.turn("stop");for(var d=0;d<c.length;d++)c[d]&&b.pageZoom[c[d]]!=b.zoom&&(this.trigger("zoomed",[c[d],c,b.pageZoom[c[d]],b.zoom]),b.pageZoom[c[d]]=b.zoom);p._removeFromDOM.call(this),p._makeRange.call(this),p._updateShadow.call(this),this.trigger("turned",[a,c]),this.turn("update"),b.opts.autoCenter&&this.turn("center")}},_turnPage:function(b){var c,d,e=this.data(),f=e.pagePlace[b],g=this.turn("view"),h=this.turn("view",b);if(e.page!=b){var i=e.page;if("prevented"==E("turning",this,[b,h]))return void(i==e.page&&-1!=a.inArray(f,e.pageMv)&&e.pages[f].flip("hideFoldedPage",!0));-1!=a.inArray(1,h)&&this.trigger("first"),-1!=a.inArray(e.totalPages,h)&&this.trigger("last")}"single"==e.display?(c=g[0],d=h[0]):g[1]&&b>g[1]?(c=g[1],d=h[0]):g[0]&&b<g[0]&&(c=g[0],d=h[1]);var j=e.opts.turnCorners.split(","),k=e.pages[c].data().f,l=k.opts,m=k.point;p._missing.call(this,b),e.pageObjs[b]&&(this.turn("stop"),e.page=b,p._makeRange.call(this),e.tpage=d,l.next!=d&&(l.next=d,l.force=!0),this.turn("update"),k.point=m,"hard"==k.effect?"ltr"==e.direction?e.pages[c].flip("turnPage",b>c?"r":"l"):e.pages[c].flip("turnPage",b>c?"l":"r"):"ltr"==e.direction?e.pages[c].flip("turnPage",j[b>c?1:0]):e.pages[c].flip("turnPage",j[b>c?0:1]))},page:function(b){var c=this.data();if(void 0===b)return c.page;if(!c.disabled&&!c.destroying){if((b=parseInt(b,10))>0&&b<=c.totalPages)return b!=c.page&&(c.done&&-1==a.inArray(b,this.turn("view"))?p._turnPage.call(this,b):p._fitPage.call(this,b)),this;throw F("The page "+b+" does not exist")}},next:function(){return this.turn("page",Math.min(this.data().totalPages,p._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,p._view.call(this,this.data().page).shift()-1))},peel:function(a,b){var c=this.data(),d=this.turn("view");if(b=void 0===b||!0===b,!1===a)this.turn("stop",null,b);else if("single"==c.display)c.pages[c.page].flip("peel",a,b);else{var e;e="ltr"==c.direction?-1!=a.indexOf("l")?d[0]:d[1]:-1!=a.indexOf("l")?d[1]:d[0],c.pages[e]&&c.pages[e].flip("peel",a,b)}return this},_addMotionPage:function(){var b=a(this).data().f.opts,c=b.turn;c.data();p._addMv.call(c,b.page)},_eventStart:function(a,b,c){var d=b.turn.data(),e=d.pageZoom[b.page];if(a.isDefaultPrevented())return void p._updateShadow.call(b.turn);e&&e!=d.zoom&&(b.turn.trigger("zoomed",[b.page,b.turn.turn("view",b.page),e,d.zoom]),d.pageZoom[b.page]=d.zoom),"single"==d.display&&c&&("l"==c.charAt(1)&&"ltr"==d.direction||"r"==c.charAt(1)&&"rtl"==d.direction?(b.next=b.next<b.page?b.next:b.page-1,b.force=!0):b.next=b.next>b.page?b.next:b.page+1),p._addMotionPage.call(a.target),p._updateShadow.call(b.turn)},_eventEnd:function(b,c,d){var e=a(b.target),g=(e.data().f,c.turn),h=g.data();if(d){var i=h.tpage||h.page;i!=c.next&&i!=c.page||(delete h.tpage,p._fitPage.call(g,i||c.next,!0))}else p._removeMv.call(g,c.page),p._updateShadow.call(g),g.turn("update")},_eventPressed:function(b){var d=a(b.target).data().f,e=d.opts.turn,f=e.data();f.pages;return f.mouseAction=!0,e.turn("update"),d.time=(new Date).getTime()},_eventReleased:function(b,c){var d,e=a(b.target),f=e.data().f,g=f.opts.turn,h=g.data();d="single"==h.display?"br"==c.corner||"tr"==c.corner?c.x<e.width()/2:c.x>e.width()/2:c.x<0||c.x>e.width(),((new Date).getTime()-f.time<200||d)&&(b.preventDefault(),p._turnPage.call(g,f.opts.next)),h.mouseAction=!1},_flip:function(b){b.stopPropagation();var c=a(b.target).data().f.opts;c.turn.trigger("turn",[c.next]),c.turn.data().opts.autoCenter&&c.turn.turn("center",c.next)},_touchStart:function(){var a=this.data();for(var b in a.pages)if(A(b,a.pages)&&!1===q._eventStart.apply(a.pages[b],arguments))return!1},_touchMove:function(){var a=this.data();for(var b in a.pages)A(b,a.pages)&&q._eventMove.apply(a.pages[b],arguments)},_touchEnd:function(){var a=this.data();for(var b in a.pages)A(b,a.pages)&&q._eventEnd.apply(a.pages[b],arguments)},calculateZ:function(a){var b,c,d,e,f,g=this,h=this.data(),i=this.turn("view"),j=i[0]||i[1],k=a.length-1,l={pageZ:{},partZ:{},pageV:{}},m=function(a){var b=g.turn("view",a);b[0]&&(l.pageV[b[0]]=!0),b[1]&&(l.pageV[b[1]]=!0)};for(b=0;b<=k;b++)c=a[b],d=h.pages[c].data().f.opts.next,e=h.pagePlace[c],m(c),m(d),f=h.pagePlace[d]==d?d:c,l.pageZ[f]=h.totalPages-Math.abs(j-f),l.partZ[e]=2*h.totalPages-k+b;return l},update:function(){var b,c=this.data();if(this.turn("animating")&&0!==c.pageMv[0]){var d,f,g=this.turn("calculateZ",c.pageMv),h=this.turn("corner"),i=this.turn("view"),j=this.turn("view",c.tpage);for(b in c.pageWrap)A(b,c.pageWrap)&&(f=c.pageObjs[b].hasClass("fixed"),c.pageWrap[b].css({display:g.pageV[b]||f?"":"none",zIndex:(c.pageObjs[b].hasClass("hard")?g.partZ[b]:g.pageZ[b])||(f?-1:0)}),(d=c.pages[b])&&(d.flip("z",g.partZ[b]||null),g.pageV[b]&&d.flip("resize"),c.tpage?d.flip("hover",!1).flip("disable",-1==a.inArray(parseInt(b,10),c.pageMv)&&b!=j[0]&&b!=j[1]):d.flip("hover",!1===h).flip("disable",b!=i[0]&&b!=i[1])))}else for(b in c.pageWrap)if(A(b,c.pageWrap)){var k=p._setPageLoc.call(this,b);c.pages[b]&&c.pages[b].flip("disable",c.disabled||1!=k).flip("hover",!0).flip("z",null)}return this},_updateShadow:function(){var b,c,e=this.data(),f=this.width(),g=this.height(),h="single"==e.display?f:f/2;b=this.turn("view"),e.shadow||(e.shadow=a("<div />",{class:"shadow",css:s(0,0,0).css}).appendTo(this));for(var i=0;i<e.pageMv.length&&(b[0]&&b[1]);i++)b=this.turn("view",e.pages[e.pageMv[i]].data().f.opts.next),c=this.turn("view",e.pageMv[i]),b[0]=b[0]&&c[0],b[1]=b[1]&&c[1];switch(b[0]?b[1]?3:"ltr"==e.direction?2:1:"ltr"==e.direction?1:2){case 1:e.shadow.css({width:h,height:g,top:0,left:h});break;case 2:e.shadow.css({width:h,height:g,top:0,left:0});break;case 3:e.shadow.css({width:f,height:g,top:0,left:0})}},_setPageLoc:function(a){var b=this.data(),c=this.turn("view"),d=0;if(a==c[0]||a==c[1]?d=1:("single"==b.display&&a==c[0]+1||"double"==b.display&&a==c[0]-2||a==c[1]+2)&&(d=2),!this.turn("animating"))switch(d){case 1:b.pageWrap[a].css({zIndex:b.totalPages,display:""});break;case 2:b.pageWrap[a].css({zIndex:b.totalPages-1,display:""});break;case 0:b.pageWrap[a].css({zIndex:0,display:b.pageObjs[a].hasClass("fixed")?"":"none"})}return d},options:function(b){if(void 0===b)return this.data().opts;var c=this.data();if(a.extend(c.opts,b),b.pages&&this.turn("pages",b.pages),b.page&&this.turn("page",b.page),b.display&&this.turn("display",b.display),b.direction&&this.turn("direction",b.direction),b.width&&b.height&&this.turn("size",b.width,b.height),b.when)for(var d in b.when)A(d,b.when)&&this.unbind(d).bind(d,b.when[d]);return this},version:function(){return e}},q={init:function(a){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",a),q._addPageWrapper.call(this),this},setData:function(b){var c=this.data();return c.f=a.extend(c.f,b),this},options:function(b){var c=this.data().f;return b?(q.setData.call(this,{opts:a.extend({},c.opts||n,b)}),this):c.opts},z:function(a){var b=this.data().f;return b.opts["z-index"]=a,b.fwrapper&&b.fwrapper.css({zIndex:a||parseInt(b.parent.css("z-index"),10)||0}),this},_cAllowed:function(){var a=this.data().f,b=a.opts.page,c=a.opts.turn.data(),d=b%2;return"hard"==a.effect?"ltr"==c.direction?[d?"r":"l"]:[d?"l":"r"]:"single"==c.display?1==b?"ltr"==c.direction?j.forward:j.backward:b==c.totalPages?"ltr"==c.direction?j.backward:j.forward:j.all:"ltr"==c.direction?j[d?"forward":"backward"]:j[d?"backward":"forward"]},_cornerActivated:function(b){var c=this.data().f,d=this.width(),e=this.height(),f={x:b.x,y:b.y,corner:""},g=c.opts.cornerSize;if(f.x<=0||f.y<=0||f.x>=d||f.y>=e)return!1;var h=q._cAllowed.call(this);switch(c.effect){case"hard":if(f.x>d-g)f.corner="r";else{if(!(f.x<g))return!1;f.corner="l"}break;case"sheet":if(f.y<g)f.corner+="t";else{if(!(f.y>=e-g))return!1;f.corner+="b"}if(f.x<=g)f.corner+="l";else{if(!(f.x>=d-g))return!1;f.corner+="r"}}return!(!f.corner||-1==a.inArray(f.corner,h))&&f},_isIArea:function(a){var b=this.data().f.parent.offset();return a=h&&a.originalEvent?a.originalEvent.touches[0]:a,q._cornerActivated.call(this,{x:a.pageX-b.left,y:a.pageY-b.top})},_c:function(a,b){switch(b=b||0,a){case"tl":return w(b,b);case"tr":return w(this.width()-b,b);case"bl":return w(b,this.height()-b);case"br":return w(this.width()-b,this.height()-b);case"l":return w(b,0);case"r":return w(this.width()-b,0)}},_c2:function(a){switch(a){case"tl":return w(2*this.width(),0);case"tr":return w(-this.width(),0);case"bl":return w(2*this.width(),this.height());case"br":return w(-this.width(),this.height());case"l":return w(2*this.width(),0);case"r":return w(-this.width(),0)}},_foldingPage:function(){var a=this.data().f;if(a){var b=a.opts;return b.turn?(a=b.turn.data(),"single"==a.display?b.next>1||b.page>1?a.pageObjs[0]:null:a.pageObjs[b.next]):void 0}},_backGradient:function(){var b=this.data().f,c=b.opts.turn.data(),d=c.opts.gradients&&("single"==c.display||2!=b.opts.page&&b.opts.page!=c.totalPages-1);return d&&!b.bshadow&&(b.bshadow=a("<div/>",s(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(b.parent)),d},type:function(){return this.data().f.effect},resize:function(a){var b=this.data().f,c=b.opts.turn.data(),d=this.width(),e=this.height();switch(b.effect){case"hard":a&&(b.wrapper.css({width:d,height:e}),b.fpage.css({width:d,height:e}),c.opts.gradients&&(b.ashadow.css({width:d,height:e}),b.bshadow.css({width:d,height:e})));break;case"sheet":if(a){var f=Math.round(Math.sqrt(Math.pow(d,2)+Math.pow(e,2)));b.wrapper.css({width:f,height:f}),b.fwrapper.css({width:f,height:f}).children(":first-child").css({width:d,height:e}),b.fpage.css({width:d,height:e}),c.opts.gradients&&b.ashadow.css({width:d,height:e}),q._backGradient.call(this)&&b.bshadow.css({width:d,height:e})}if(b.parent.is(":visible")){var g=G(b.parent[0]);b.fwrapper.css({top:g.top,left:g.left}),g=G(b.opts.turn[0]),b.fparent.css({top:-g.top,left:-g.left})}this.flip("z",b.opts["z-index"])}},_addPageWrapper:function(){var c=this.data().f,e=c.opts.turn.data(),f=this.parent();if(c.parent=f,!c.wrapper)switch(c.effect){case"hard":var g={};g[d+"transform-style"]="preserve-3d",g[d+"backface-visibility"]="hidden",c.wrapper=a("<div/>",s(0,0,2)).css(g).appendTo(f).prepend(this),c.fpage=a("<div/>",s(0,0,1)).css(g).appendTo(f),e.opts.gradients&&(c.ashadow=a("<div/>",s(0,0,0)).hide().appendTo(f),c.bshadow=a("<div/>",s(0,0,0)));break;case"sheet":var h=this.width(),i=this.height();Math.round(Math.sqrt(Math.pow(h,2)+Math.pow(i,2)));if(c.fparent=c.opts.turn.data().fparent,!c.fparent){var k=a("<div/>",{css:{"pointer-events":"none"}}).hide();k.data().flips=0,k.css(s(0,0,"auto","visible").css).appendTo(c.opts.turn),c.opts.turn.data().fparent=k,c.fparent=k}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),c.wrapper=a("<div/>",s(0,0,this.css("z-index"))).appendTo(f).prepend(this),c.fwrapper=a("<div/>",s(f.offset().top,f.offset().left)).hide().appendTo(c.fparent),c.fpage=a("<div/>",s(0,0,0,"visible")).css({cursor:"default"}).appendTo(c.fwrapper),e.opts.gradients&&(c.ashadow=a("<div/>",s(0,0,1)).appendTo(c.fpage)),q.setData.call(this,c)}q.resize.call(this,!0)},_fold:function(a){var b=this.data().f,e=b.opts.turn.data(),h=q._c.call(this,a.corner),i=this.width(),j=this.height();switch(b.effect){case"hard":"l"==a.corner?a.x=Math.min(Math.max(a.x,0),2*i):a.x=Math.max(Math.min(a.x,i),-i);var k,l,m,n,o,p=e.totalPages,r=b.opts["z-index"]||p,s={overflow:"visible"},t=h.x?(h.x-a.x)/i:a.x/i,u=90*t,x=u<90;switch(a.corner){case"l":n="0% 50%",o="100% 50%",x?(k=0,l=b.opts.next-1>0,m=1):(k="100%",l=b.opts.page+1<p,m=0);break;case"r":n="100% 50%",o="0% 50%",u=-u,i=-i,x?(k=0,l=b.opts.next+1<p,m=0):(k="-100%",l=1!=b.opts.page,m=1)}s[d+"perspective-origin"]=o,b.wrapper.transform("rotateY("+u+"deg)translate3d(0px, 0px, "+(this.attr("depth")||0)+"px)",o),b.fpage.transform("translateX("+i+"px) rotateY("+(180+u)+"deg)",n),b.parent.css(s),x?(t=1-t,b.wrapper.css({zIndex:r+1}),b.fpage.css({zIndex:r})):(t-=1,b.wrapper.css({zIndex:r}),b.fpage.css({zIndex:r+1})),e.opts.gradients&&(l?b.ashadow.css({display:"",left:k,backgroundColor:"rgba(0,0,0,"+.5*t+")"}).transform("rotateY(0deg)"):b.ashadow.hide(),b.bshadow.css({opacity:1-t}),x?b.bshadow.parent()[0]!=b.wrapper[0]&&b.bshadow.appendTo(b.wrapper):b.bshadow.parent()[0]!=b.fpage[0]&&b.bshadow.appendTo(b.fpage),D(b.bshadow,w(100*m,0),w(100*(1-m),0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var F,G,H,I,J,K,L,A=this,B=0,C=0,M=w(0,0),N=w(0,0),O=w(0,0),P=q._foldingPage.call(this),R=(Math.tan(C),e.opts.acceleration),S=b.wrapper.height(),T="t"==a.corner.substr(0,1),U="l"==a.corner.substr(1,1),V=function(){var b=w(0,0),d=w(0,0);b.x=h.x?h.x-a.x:a.x,b.y=c?h.y?h.y-a.y:a.y:0,d.x=U?i-b.x/2:a.x+b.x/2,d.y=b.y/2;var k=g-Math.atan2(b.y,b.x),l=k-Math.atan2(d.y,d.x),m=Math.max(0,Math.sin(l)*Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2)));if(B=v(k),O=w(m*Math.sin(k),m*Math.cos(k)),k>g&&(O.x=O.x+Math.abs(O.y*b.y/b.x),O.y=0,Math.round(O.x*Math.tan(f-k))<j))return a.y=Math.sqrt(Math.pow(j,2)+2*d.x*b.x),T&&(a.y=j-a.y),V();if(k>g){var n=f-k,o=S-j/Math.sin(n);M=w(Math.round(o*Math.cos(n)),Math.round(o*Math.sin(n))),U&&(M.x=-M.x),T&&(M.y=-M.y)}F=Math.round(O.y/Math.tan(k)+O.x);var p=i-F,r=p*Math.cos(2*k),s=p*Math.sin(2*k);if(N=w(Math.round(U?p-r:F+r),Math.round(T?s:j-s)),e.opts.gradients){J=p*Math.sin(k);var t=q._c2.call(A,a.corner),u=Math.sqrt(Math.pow(t.x-a.x,2)+Math.pow(t.y-a.y,2))/i;L=Math.sin(g*(u>1?2-u:u)),K=Math.min(u,1),I=J>100?(J-100)/J:0,G=w(J*Math.sin(k)/i*100,J*Math.cos(k)/j*100),q._backGradient.call(A)&&(H=w(1.2*J*Math.sin(k)/i*100,1.2*J*Math.cos(k)/j*100),U||(H.x=100-H.x),T||(H.y=100-H.y))}return O.x=Math.round(O.x),O.y=Math.round(O.y),!0},W=function(a,c,d,f){var g=["0","auto"],h=(i-S)*d[0]/100,k=(j-S)*d[1]/100,l={left:g[c[0]],top:g[c[1]],right:g[c[2]],bottom:g[c[3]]},m={},n=90!=f&&-90!=f?U?-1:1:0,o=d[0]+"% "+d[1]+"%";A.css(l).transform(z(f)+y(a.x+n,a.y,R),o),b.fpage.css(l).transform(z(f)+y(a.x+N.x-M.x-i*d[0]/100,a.y+N.y-M.y-j*d[1]/100,R)+z((180/f-2)*f),o),b.wrapper.transform(y(-a.x+h-n,-a.y+k,R)+z(-f),o),b.fwrapper.transform(y(-a.x+M.x+h,-a.y+M.y+k,R)+z(-f),o),e.opts.gradients&&(d[0]&&(G.x=100-G.x),d[1]&&(G.y=100-G.y),m["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*L+")",P.css(m),D(b.ashadow,w(U?100:0,T?0:100),w(G.x,G.y),[[I,"rgba(0,0,0,0)"],[.8*(1-I)+I,"rgba(0,0,0,"+.2*K+")"],[1,"rgba(255,255,255,"+.2*K+")"]],3,C),q._backGradient.call(A)&&D(b.bshadow,w(U?0:100,T?0:100),w(H.x,H.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*K+")"],[1,"rgba(0,0,0,0)"]],3))};switch(a.corner){case"l":case"r":break;case"tl":a.x=Math.max(a.x,1),V(),W(O,[1,0,0,1],[100,0],B);break;case"tr":a.x=Math.min(a.x,i-1),V(),W(w(-O.x,O.y),[0,0,0,1],[0,0],-B);break;case"bl":a.x=Math.max(a.x,1),V(),W(w(O.x,-O.y),[1,1,0,0],[100,100],-B);break;case"br":a.x=Math.min(a.x,i-1),V(),W(w(-O.x,-O.y),[0,1,1,0],[0,100],B)}}b.point=a},_moveFoldingPage:function(a){var b=this.data().f;if(b){var c=b.opts.turn,d=c.data(),e=d.pagePlace;if(a){var f=b.opts.next;if(e[f]!=b.opts.page){b.folding&&q._moveFoldingPage.call(this,!1);q._foldingPage.call(this).appendTo(b.fpage),e[f]=b.opts.page,b.folding=f}c.turn("update")}else if(b.folding){if(d.pages[b.folding]){var h=d.pages[b.folding].data().f;d.pageObjs[b.folding].appendTo(h.wrapper)}else d.pageWrap[b.folding]&&d.pageObjs[b.folding].appendTo(d.pageWrap[b.folding]);b.folding in e&&(e[b.folding]=b.folding),delete b.folding}}},_showFoldedPage:function(a,b){var c=q._foldingPage.call(this),d=this.data(),e=d.f,f=e.visible;if(c){if(!f||!e.point||e.point.corner!=a.corner){var g="hover"==e.status||"peel"==e.status||e.opts.turn.data().mouseAction?a.corner:null;if(f=!1,"prevented"==E("start",this,[e.opts,g]))return!1}if(b){var h=this,i=e.point&&e.point.corner==a.corner?e.point:q._c.call(this,a.corner,1);this.animatef({from:[i.x,i.y],to:[a.x,a.y],duration:500,frame:function(b){a.x=Math.round(b[0]),a.y=Math.round(b[1]),q._fold.call(h,a)}})}else q._fold.call(this,a),d.effect&&!d.effect.turning&&this.animatef(!1);if(!f)switch(e.effect){case"hard":e.visible=!0,q._moveFoldingPage.call(this,!0),e.fpage.show(),e.opts.shadows&&e.bshadow.show();break;case"sheet":e.visible=!0,e.fparent.show().data().flips++,q._moveFoldingPage.call(this,!0),e.fwrapper.show(),e.bshadow&&e.bshadow.show()}return!0}return!1},hide:function(){var a=this.data().f,b=a.opts.turn.data(),c=q._foldingPage.call(this);switch(a.effect){case"hard":b.opts.gradients&&(a.bshadowLoc=0,a.bshadow.remove(),a.ashadow.hide()),a.wrapper.transform(""),a.fpage.hide();break;case"sheet":0==--a.fparent.data().flips&&a.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform(""),a.wrapper.transform(""),a.fwrapper.hide(),a.bshadow&&a.bshadow.hide(),c.transform("")}return a.visible=!1,this},hideFoldedPage:function(a){var b=this.data().f;if(b.point){var c=this,d=b.point,e=function(){b.point=null,b.status="",c.flip("hide"),c.trigger("end",[b.opts,!1])};if(a){var f=q._c.call(this,d.corner),g="t"==d.corner.substr(0,1),h=g?Math.min(0,d.y-f.y)/2:Math.max(0,d.y-f.y)/2,i=w(d.x,d.y+h),j=w(f.x,f.y-h);this.animatef({from:0,to:1,frame:function(a){var b=t(d,i,j,f,a);d.x=b.x,d.y=b.y,q._fold.call(c,d)},complete:e,duration:800,hiding:!0})}else this.animatef(!1),e()}},turnPage:function(a){var b=this,c=this.data().f,d=c.opts.turn.data();a={corner:c.corner?c.corner.corner:a||q._cAllowed.call(this)[0]};var e=c.point||q._c.call(this,a.corner,c.opts.turn?d.opts.elevation:0),f=q._c2.call(this,a.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(c){var d=t(e,e,f,f,c);a.x=d.x,a.y=d.y,q._showFoldedPage.call(b,a)},complete:function(){b.trigger("end",[c.opts,!0])},duration:d.opts.duration,turning:!0}),c.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(a){var b=this.data().f,c=b.opts.turn;if(!b.corner&&!b.disabled&&!this.flip("isTurning")&&b.opts.page==c.data().pagePlace[b.opts.page]){if(b.corner=q._isIArea.call(this,a),b.corner&&q._foldingPage.call(this))return this.trigger("pressed",[b.point]),q._showFoldedPage.call(this,b.corner),!1;b.corner=null}},_eventMove:function(a){var b=this.data().f;if(!b.disabled)if(a=h?a.originalEvent.touches:[a],b.corner){var c=b.parent.offset();b.corner.x=a[0].pageX-c.left,b.corner.y=a[0].pageY-c.top,q._showFoldedPage.call(this,b.corner)}else if(b.hover&&!this.data().effect&&this.is(":visible")){var d=q._isIArea.call(this,a[0]);if(d){if("sheet"==b.effect&&2==d.corner.length||"hard"==b.effect){b.status="hover";var e=q._c.call(this,d.corner,b.opts.cornerSize/2);d.x=e.x,d.y=e.y,q._showFoldedPage.call(this,d,!0)}}else"hover"==b.status&&(b.status="",q.hideFoldedPage.call(this,!0))}},_eventEnd:function(){var a=this.data().f,b=a.corner;!a.disabled&&b&&"prevented"!=E("released",this,[a.point||b])&&q.hideFoldedPage.call(this,!0),a.corner=null},disable:function(a){return q.setData.call(this,{disabled:a}),this},hover:function(a){return q.setData.call(this,{hover:a}),this},peel:function(b,c){var d=this.data().f;if(b){if(-1==a.inArray(b,j.all))throw F("Corner "+b+" is not permitted");if(-1!=a.inArray(b,q._cAllowed.call(this))){var e=q._c.call(this,b,d.opts.cornerSize/2);d.status="peel",q._showFoldedPage.call(this,{corner:b,x:e.x,y:e.y},c)}}else d.status="",q.hideFoldedPage.call(this,c);return this}};window.requestAnim=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),a.extend(a.fn,{flip:function(){return r(a(this[0]),q,arguments)},turn:function(){return r(a(this[0]),p,arguments)},transform:function(a,b){var c={};return b&&(c[d+"transform-origin"]=b),c[d+"transform"]=a,this.css(c)},animatef:function(b){var c=this.data();if(c.effect&&c.effect.stop(),b){b.to.length||(b.to=[b.to]),b.from.length||(b.from=[b.from]);for(var d=[],e=b.to.length,f=!0,g=this,h=(new Date).getTime(),i=function(){if(c.effect&&f){for(var a=[],j=Math.min(b.duration,(new Date).getTime()-h),k=0;k<e;k++)a.push(c.effect.easing(1,j,b.from[k],d[k],b.duration));b.frame(1==e?a[0]:a),j==b.duration?(delete c.effect,g.data(c),b.complete&&b.complete()):window.requestAnim(i)}},j=0;j<e;j++)d.push(b.to[j]-b.from[j]);c.effect=a.extend({stop:function(){f=!1},easing:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c}},b),this.data(c),i()}else delete c.effect}}),a.isTouch=h,a.mouseEvents=i,a.cssPrefix=B,a.cssTransitionEnd=C,a.findPos=G}(jQuery);
